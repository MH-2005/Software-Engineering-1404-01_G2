 
 به نام خدا 
 
 
 
دانشكده مهندسی کامپیوتر 
مهندسی نرم افزار 1 
 
" فاز7 پروژه" 
 
موضوع پروژه: 
پیادهسازی  
 
 
استاد درس: دکتر کلباسی 
 
مهلت تحویل: باتوجه به  مهلت ثبت موقت نمرات پایانترم، اعالم خواهد شد. 
 
نیمسال اول  1404

1 
 
 1. معرفی کلی پروژه و ساختار پایه معماری 
این پروژه یک سامانهی وب چندبخشی با موضوع نقشه و جغرافیای ایران است که در قالب یک معماری سرویس گرا 
طراحی شده است. در این سامانه، مجموعهای از خدمات مستقل در  کنار یکدیگر قرار میگیرند که هر کدام  
وظیفهی مشخصی را بر عهده دارند و در مجموع یک ابزار جامع برای مدیریت، پردازش و بهبود داده ها فراهم 
میکنند. 
هر تیم مسئول طراحی و پیادهسازی یک خدمت یا میکروسرویس مشخص است. این میکروسرویس ها بهصورت  
مستقل توسعه داده میشوند اما همگی باید به سامانه ی مرکزی متصل باشند تا خروجی نهایی پروژه بهصورت  
یکپارچه در اختیار کاربر قرار گیرد. سامانهی مرکزی توسط تیم پایه ی پروژه پیادهسازی شده است و تیم ها صرفاً 
وظیفهی توسعه ی سرویسهای اختصاصی خود را دارند . 
در پیادهسازی سرویس ها، تیمها در انتخاب زبان برنامه نویسی و فریمورک آزادی عمل دارند. در صورتی که سرویس  
تیم خارج از  Djang  - توسعه داده شود، الزم است ارتباط میان میکروسرویس خارجی و سامانه ی مرکزی  
Djang  -  برقرار شود. این ارتباط می تواند از روش های مختلفی انجام شود؛ از جمله استفاده از  gRPC یا 
message broker هایی مانند RabbitMQ، انتخاب روش ارتباطی به عهدهی تیم است، اما باید با معماری  
کلی پروژه سازگار باشد. 
 
2. نقش و مسئولیت سامانهی مرکزی   (Djang  - Core) 
سامانهی مرکزی  Djang  - بهعنوان هسته ی اصلی پروژه عمل میکند و مسئولیت قابلیت های مشترک میان تمام  
تیمها را بر عهده دارد. این سامانه وظایف زیر را انجام می دهد: 
-  مدیریت احراز هویت کاربران شامل ثبتنام، ورود و خروج  
-  نگهداری وضعیت احراز هویت کاربر از طریق Session و Cookie 
-  ارائهی API های مشترک برای بررسی وضعیت کاربر 
-  نگهداری ساختار کلی پروژه و مسیرهای اصلی 
-  فراهمسازی یک نقطه ی اتصال استاندارد برای سرویسهای تیمی  
تمام درخواستهایی که به سامانه ی مرکزی  Djang  - میرسند، باید به یک مسیر مشخص  (Sub -URL)  هدایت
شوند که مربوط به سرویس تیم است. هر تیم میتواند  API  های اختصاصی خود را در همین مسیرها تعریف و
مدیریت کند. 

2 
 
 3. ساختار کلی پروژه و محل توسعه تیمها 
در شاخهی اصلی ریپازیتوری، برای هر تیم یک فولدر مجزا در نظر گرفته شده است. هر تیم موظف است تمام  
تغییرات، کدها و فایلهای مربوط به پروژه ی خود را صرفاً در فولدر اختصاصی همان تیم انجام دهد. 
بهعنوان مثال، اگر تیم  مربوطه  Team 1  باشد، تمام تغییرات باید در فولدر team 1    انجام شود. تغییر ساختار
کلی پروژه یا فایلهای سایر تیم ها مجاز نیست و در صورت نیاز به تغییرات ساختاری، باید ابتدا هماهنگی الزم 
انجام شود. 
برای هر تیم، یک  Application جداگانه در  Djang  - در نظر گرفته شده است که با نام همان تیم نامگذاری  
شده است. همچنین فایل urls.py  مربوط به آن  Application  در اختیار تیم قرار دارد تا مسیرهای مورد نیاز
سرویس خود را در آن تعریف کند. 
در صورتی که تیم قصد استفاده از  Djang  - را نداشته باشد، میتواند میکروسرویس خود را با هر زبان یا  فریمورک 
دیگری توسعه دهد و از طریق روشهای ارتباطی تعریف شده )مانند HTTP  ، gRPC  یا  message broker)  
به سامانهی مرکزی متصل شود . 
 
4. استفاده از  Docker در معماری پروژه 
 Docker در این پروژه به عنوان بستر اصلی اجرای سرویس ها استفاده شده است. تمام اجزای پروژه، شا مل 
سامانهی مرکزی و سرویس های تیمی، در قالب کانتینرهای  Docker اجرا میشوند. این رویکرد باعث می شود 
محیط اجرا برای تمام تیمها یکسان باشد و مدیریت وابستگی ها و اجرای همزمان سرویس ها سادهتر انجام شود . 
هر تیم سرویسهای خود را به صورت مستقل در  Docker اجرا میکند و نیازی به اجرای مستقیم آن ها روی 
سیستم میزبان وجود ندارد. ارتباط میان سرویسها از طریق شبکه ی داخلی  Docker برقرار میشود. 
 
 
 
 
 
 
 

3 
 
 5.  Docker Compose و نحوهی اضافه کردن سرویس جدید  
برای هر تیم یک فایل docker -compose.yml   در فولدر همان تیم وجود دارد. این فایل محل تعریف تمام 
سرویسهای تیم است. در صورت نیاز به اضافه کردن یک سرویس جدید، تیم باید مراحل زیر را انجام دهد : 
-  تعریف سرویس جدید در فایل  docker -compose تیم 
-  قرار دادن سرویس در شبکهی مشترک پروژه  
-  تعریف متغیرهای محیطی مورد نیاز سرویس 
-  اتصال سرویس به  Gateway  تیم ازطریق  Nginx 
هیچ نیازی به تغییر  docker -compose سامانهی مرکزی یا تیم های دیگر وجود ندارد. 
 
6. نقش  Nginx و منطق استفاده از آن در پروژه 
در این پروژه،  Nginx بهعنوان  Gateway هر تیم استفاده میشود . Gateway  تنها نقطهی ورودی تیم از  
بیرون است و تمام درخواستهای مربو ط به آن تیم ابتدا وارد  Nginx میشوند. 
منطق استفاده از  Nginx به این صورت است که هر تیم تنها یک پورت روی سیستم میزبان دارد و این پورت به 
Nginx  متصل است . Nginx  بر اساس مسیر  URL تصمیم میگیرد درخواست به کدام سرویس داخلی تیم  
هدایت شود. 
در صورتی که تیم سرویس جدیدی اضافه کند، کافی است: 
-  سرویس را در  docker -compose اضافه کند 
-  یک مسیر جدید برای آن سرویس در فایل تنظیمات  Nginx تعریف کند 
بدون آنکه پورت جدیدی روی سیستم میزبان باز شود. 
 
 
 
 
 

4 
 
 7. پایگاه داده و نحوهی استفاده تیم ها 
در سامانهی مرکزی مبتنی بر  Djang  - ، یک پایگاه دادهی ابری  MySQL  بهعنوان دیتابیس اصلی پروژه در نظر  
گرفته شده است. اطالعات اتصال به این دیتابیس از طریق متغیرهای محیطی ( Environment Variables ) 
در اختیار هر تیم قرار میگیرد. 
هر تیم: 
-  یک نام کاربری و رمز عبور اختصاصی دریافت میکند. 
-  این اطالعات صرفاً مختص همان تیم بوده و نباید در اختیار سایر تیمها قرار گیرد . 
-  دسترسی هر تیم محدود به جدولهایی است که در فازهای قبلی برای همان تیم ایجاد شده اند. 
-  هیچ تیمی امکان مشاهده یا دسترسی به جدولهای سایر  تیمها را ندارد . 
برای اتصال به دیتابیس مرکزی: 
-  کافی است متغیر مربوط به اتصال دیتابیس تیم در فایل .env  تعریف شود. 
-  نحوهی افزودن این متغیر در فایل  .env.example  توضیح داده شده است. 
-  هیچ تنظیم اضافی دیگری الزم نیست و سرویسهای تیم می توانند مستقیماً از این متغیر استفاده کنند. 
سطح دسترسی تیمها به دیتابیس ابری شامل موارد زیر است : 
-  SELECT  ) خواندن دادهها( 
-  INSERT  ) افزودن دادهها( 
-  UPDATE  ) ویرایش دادهها( 
در مرحلهی توسعه : 
-  تیمها میتوانند از دیتابیس محلی  Djang  - مانند  SQLite استفاده کنند. 
-  مدلها و  migration ها بهصورت محلی اجرا می شوند. 
-  اعمال  migration روی دیتابیس اصلی صرفاً پس از بررسی و تأیید تیم تدریسیاری انجام میشود. 
 
 

5 
 
 در صورت نیاز به: 
-  ایجاد جدول جدید  (CREATE )  
-  تغییر ساختار جدول  (ALTER )  
-  حذف جدول  (DROP )  
تیمها باید : 
1. دستور SQL   مربوطه را در بخش« پایگاه داده » این شیت ثبت کنند. 
2. توضیح مختصری درباره هدف تغییر ارائه دهند. 
3. پس از بررسی و تأیید تیم تدریسیاری، تغییر موردنظر روی دیتابیس ابری اعمال خواهد شد. 
 
7-1  . نحوه استفاده تیمها از دیتابیس در کد  جنگو 
در تنظیمات پروژه، برای هر تیم یک اتصال پایگاه داده مستقل بر اساس متغیر محیطی  
<TEAMNAME>_DATABASE_URL 
 تعریف شده است. برای مثال، تیم team 1   از متغیر TEAM 1_DATABASE_URL   استفاده میکند. 
در صورتی که این متغیر محیطی در فایل  env تعریف نشده باشد، پروژه بهصورت خودکار از یک دیتابیس محلی  
SQLite  مخصوص همان تیم استفاده میکند که در مسیر فولدر ت یم ایجاد میشود. این رفتار امکان توسعه و  
تست محلی را بدون نیاز به دیتابیس ابری فراهم میکند. 
هدایت درخواستهای دیتابیس توسط یک  Router انجام میشود  (TeamPerAppRouter) که باعث میشود 
تمام عملیات خواندن و نوشتن هر اپلیکیشن به دیتابیس مربوط به همان تیم ارسال شود و از تداخل میان تیمها 
جلوگیری گردد. 
در کد  Djang  - تیمها، استفاده از  ORM بهصورت معمول کافی است و نیازی به تعیین دستی دیتابیس وجود  
ندارد. در صورت نیاز خاص، تیم میتواند به صورت صریح از  alias  مربوط به تیم خود(مثالً team 1 )   استفاده
کند. 
 
 
 

6 
 
 8. اتصال سرویسهای تیم به سامانهی مرکزی  
سرویسهایی که نیاز به ارتباط با سامانه ی مرکزی دارند، باید در همان شبکهی  Docker که  Core  در آن قرار
دارد تعریف شوند. برای این منظور، در  docker -compose تیم: 
-  شبکهی app404_net  به سرویس اضافه میشود 
-  متغیر محیطی CORE_BASE_URL   مقداردهیمیشود 
این موارد به صورت پیش فرض و برای مثال در فایل docker -compose   هر تیم قرار داده شده تا با نحوه
استفاده از آن آشنا شوید. 
به این ترتیب، سرویس تیم میتواند  API های سامانهی مرکزی را از طریق آدرس داخلی  Docker  فراخوانی کند،
بهصورت : 
core:8000/api/...  
core:8000/team1/map  
این آدرس فقط در داخل شبکهی  Docker معتبر است و بهعنوان یک متغیر محیطی در کد سرویس استفاده  
میشود. 
 
9. احراز هویت و هدایت درخواستها 
احراز هویت کاربران بهصورت کامل در سامانه ی مرکزی انجام میشود. پس از ورود کاربر، اطالعات احراز هویت  
در قالب  Cookie ذخیره میشود. این  Cookie توسط  Nginx بدون تغییر به سرویسهای تیمی منتقل می شود. 
سرویسهای تیمی می توانند با ارسال درخواست به  API های احراز هویت سامانهی مرکزی  با استفاده از Cookie 
کاربر، وضعیت کاربر را بررسی کرده و در صورت نیاز اطالعات کاربر را در یافت کنند. تیم نیازی به پیادهسازی  
منطق احراز هویت یا اعتبارسنجی توکن ندارد. 
CORE_BASE_URL:8000/api/auth/me/  
CORE_BASE_URL:8000/api/auth/verify/  
 
 
 

7 
 
 10. مسیرهای دسترسی و  Sub-URL ها 
تمام درخواستهایی که به سامانه ی مرکزی میرسند باید به  Sub-URL  مربوط به سرویستیم هدایت شوند. هر  
تیم میتواند مسیرهای مختلفی برای سرویس خود تعریف کند . 
برای مثال: 
-  سرویس Map: 
  - /team1 /map  
  - /team1 /map /eta 
-  سرویس trip plan: 
  - /team2 /plan  
  - /team2 /plan /list 
با تعریف مسیرهای مختلف، تمام درخواستها به میکروسرویس تیم هدایت شده و مدیریت سرویس  بهصورت  
کامل در اختیار تیم خواهد بود. 
 
11.   اسکریپتهای اجرایی پروژه و نحوه استفاده 
بهمنظور  سادهسازی اجرای پروژه و جلوگ یری از خطاها ی ناشی از اجرا ی دستی سرویسها، مجموعهای از 
اسکریپتهای اجرایی در پروژه در نظر گرفته شده است. ا ین اسکریپتها در دو فولدر جداگانه برا ی 
سیستمعاملهای Windows  و Linux ارائه شدهاند، اما منطق عملکرد آن ها کامالً  یکسان است. 
در هر یک از این فولدرها سه اسکریپت وجود دارد که وظایف مشخصی را بر عهده دارند. 
اسکریپت up-all . (با پسوندsh  در Linux . وps1  در Windows  ) مسئولراهاندازی کامل پروژه است. این 
اسکریپت سامانهی مرکزی ( Core ) و تمامی سرویسهای تیمها را بهصورت هم زمان اجرا کرده، پورت اختصاصی 
هر تیم را تنظیم میکند و Gateway و سرویسهای مربوط به هر تیم را باال میآورد. این اسکریپت برای زمانی 
مناسب است که نیاز به اجرای کل پروژه وجود دارد. 
اسکریپت up-team برای اجرای یک تیم مشخص استفاده میشود. این اسکریپت شماره تیم را بهعنوان ورود ی 
دریافت کرده و تنها سرویسهای مربوط به همان تیم را اجرا میکند. استفاده از ا ین اسکریپت برای توسعه و تست 
روزمرهی هر تیم توصیه میشود. 

8 
 
 اسکریپت down -all  برای متوقف کردن کامل پروژه در نظر گرفته شده است. با اجرای این اسکریپت، تمامی 
سرویسهای تیمی و سامانهی مرکزی متوقف شده و منابع Docker آزاد میشوند. 
استفاده از این اسکریپتها بخشی از طراحی اجرایی پروژه محسوب میشود و اجرای پروژه بدون آنها توص یه 
نمیشود؛ زیرا تنظیم پورتها، ترتیب اجرای سرویسها و هماهنگی میان تیمها بهصورت متمرکز در ا ین اسکریپتها 
مدیریت شده است. 
 
راهانداز ی سریع پروژه 
برای اجرای سریع پروژه کافی است از ریشهی پروژه یکی از اسکریپتهای زیر اجرا شود: 
اجرای کامل پروژه: 
up-all  
اجرای یک تیم مشخص: 
up-team  
توقف کامل پروژه: 
down -all  
 در نهایت میتوانید در مرورگر خود به آدرس/ 8000 http://localhost:  برای مشاهده صفحه ابتدایی پروژه
مراجعه کنید. 
 
12.   استاندارد ظاهری و هماهنگی  UI/UX 
 برای حفظ یکپارچگی ظاهریسامانه، تیم ها باید در طراحی رابط کاربری خود از پالت رنگی، فونت و ساختار کلی 
پروژه پیروی کنند. این استاندارد شامل موارد زیر است: 
-  استفاده از فونت اصلی پروژه  (Vazirmatn) 
-  رعایت جهت راستبهچپ 
-  استفاده از رنگهای الهام گرفته از طبیعت و هویت بصری ایران 
-  حفظ ساختار کلی Header  ،  Footer و فاصلهگذاری ها مشابه سامانهی اصلی  

9 
 
 هدف از این استاندارد، ایجاد تجربهی کاربری یکپارچه است؛ به طوری که کاربر هنگام ورود به بخشهای مختلف  
سامانه، تفاوت ناگهانی در ظاهر یا رفتار رابط کاربری احساس نکند. 
برای آشنایی دقیق تر با اطالعات مربوط به ظاهر صفحه ها میتوانید فایل style.css  های موجود در پروژه را
مطالعه نمایید. 
 
13.   جمعبندی نهایی  
در این معماری، هر تیم بهصورت مستقل سرویس خود را توسعه می دهد، اما از طریق استانداردهای مشخصشده 
به سامانهی مرکزی متصل  میشود. این ساختار باعث می شود توسعهی پروژه به صورت همزمان، منظم و قابل  
مدیریت انجام شود و در نهایت خروجی تمام تیمها در قالب یک سامانه ی واحد در اختیار کاربر قرار گیرد. 
 
رعایت کدنویسی تمیز 
-  در تمامی مراحل از نامگذاری های واضح و با معنا استفاده کنید. 
-  توابع در حد امکان باید کوچک باشند و تنها یک وظیفه را انجام دهند. 
-  از نامگذاری های طوالنی نترسید؛ یک نام مناسب که مفهوم خود را توضیح دهد بهتر از نامهای کوتاه و  
مبهم است. 
-  کدهای خود را به صورت تدریجی و به مرور زمان کامیت کنید. پیامهای کامیت نیز باید با معنا  و واضح 
باشند. 
-  سعی کنید در تیم خود قراردادهایی برای کدنویسی تعریف کنید تا خروجی نهایی یکدست و منسجم 
باشد. 
-  برای کدهای خود مستندسازی کنید تا در صورت نیاز به مراجعه در آینده، فهم آن آسانتر باشد . 
-  مشابه فایل requirements.txt که در پروژه استفاده میشود و با دس تور زیر نیازمندیها را نصب  
میکند: 
pip install -r requirements.txt  
*   برای مایکروسرویس خود نیز یک فایل  requirements تعریف کرده و تمام نیازمندیهای الزم برای اجرای  
آن را در آن قرار دهید. 

10 
 
 -  برای  Application  خود در فولدر مربوط به گروه خود یک فایل README   ایجادکرده و توضیحات  
الزم را در آن قرار دهید. 
ارسال کد در گیتهاب 
آدرس ریپازیتوری: 
https://github.com/MajidNami/Software -Engineering -1404 -01_G2  
 برای توضیحات کامل، به فایل README  ریپازیتوری مراجعه کنید. 
برای ارسال کد خود، باید مراحل زیر را انجام دهید: 
1.  ریپازیتوری را Fork  کنید. 
2.  ریپازیتوری Fork   شده را Clone  کنید. 
3.  تغییرات خود را در یک Branch   جدید انجام دهید و سپس آن را Commit & Push  کنید. 
4.  درخواست Pull Request  ارسال کنید. 
- اگر در مورد استفاده از سرور جنگو و گیتهاب سوال، پیشنهاد یا مشکلی دارید، می توانید از طریق تلگرام یا 
ایمیل با راههای ارتباطی زیر  زیر در ارتباط باشید: 
moein_enayati@ |  moenayatti@gmail.com     
 
 
 
 
 

11 
 
  آنچه باید تحویل دهید 
یک فایل .zip )که حاوی پروژه نهایی شما است (آخرین نسخه از کدتان که کامیت کردید 
نکات تحویل 
●  همچنین دقت شود برای ایجاد یک تجربه کاربریساده و آسان، تمامی این خدمات باید با رابط کاربری  
کاربرپسند همراه باشند تا کاربران بتوانند بهراحتی از هر خدمت بهره ببرند.  
●  دقت کنید که تمام مراحل این فاز پروژه به صورت گروهی دنبال شود و تمام اعضا در تحقیق و انتخاب
موضوع نقش داشته باشند. 
●  فایلzip  خواسته شدهرا سرگروه در سایت  courses .آپلود کند 
● پیادهسازی میکروسرویس بدون تنظیم و اجرای صحیح ساختار  Docker و  Gateway  تیم، ناقص تلقی
شده و بهعنوان تحویل کامل این فاز در نظر گرفته نخواهد شد . 
●  فرمت نام فایلzip  به صورت P7_GroupName. zip   باشد که در آن GroupName .نام گروه است 
 